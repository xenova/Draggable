Element.prototype.DraggableJS=function(t){const e=this;function o(t,o){let n=e.parentNode.offsetWidth/e.options.grid.columns,s=e.parentNode.offsetHeight/e.options.grid.rows,i=(e.offsetWidth-n)/2,f=(e.offsetHeight-s)/2;t=Math.round((t+e.offsetLeft-(e.offsetWidth/2-e.startOffset[0]))/n)*n-i,o=Math.round((o+e.offsetTop-(e.offsetHeight/2-e.startOffset[1]))/s)*s-f,e.setPosition(t,o)}function n(t,e,o,n){e.split(" ").forEach(e=>t.addEventListener(e,o,n))}function s(t){return new WebKitCSSMatrix(window.getComputedStyle(t).webkitTransform)}function i(t){if(t instanceof MouseEvent)return t;if(t instanceof TouchEvent){let e=t.originalEvent||t;return e.touches[0]||e.changedTouches[0]||null}return null}function f(t,o,n){e.style.transform="matrix3d("+t.m11+", "+t.m12+", "+t.m13+", "+t.m14+", "+t.m21+", "+t.m22+", "+t.m23+", "+t.m24+", "+t.m31+", "+t.m32+", "+t.m33+", "+t.m34+", "+o+", "+n+", "+t.m43+", "+t.m44+")"}e.options=Object.assign({},{axis:"xy",init:function(t){},start:function(t){},drag:function(t){},end:function(t){},grid:!1},t),e.mouseDown=!1,e.style.cssText+="position:absolute;will-change: transform;transform-style:preserve-3d; -webkit-touch-callout: none; -webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;",e.parentNode.style.cssText+="will-change: transform;transform-style: preserve-3d;position: relative;",n(e,"touchmove",function(t){t.preventDefault()},{passive:!1}),n(e,"mousedown touchstart",function(t){let o=i(t),n=s(e),f=s(e.parentNode),r=e.getBoundingClientRect(),a=document.body.getBoundingClientRect();e.mouseDown=function(t){return t instanceof MouseEvent?void 0===t.buttons?1===t.which:1===t.buttons:t instanceof TouchEvent}(t),e.start=[o.pageX-n.m41*f.m11,o.pageY-n.m42*f.m22],e.startOffset=[o.offsetX||o.pageX-(r.left-a.left),o.offsetY||o.pageY-(r.top-a.top)],e.options.start.call(e,t)}),n(document,"mouseup touchend",function(t){if(e.mouseDown){if(e.mouseDown=!1,e.options.grid&&e.options.grid.dragEndSnap){let t=s(e);o(t.m41,t.m42)}e.options.end.call(e,t)}}),n(document,"mousemove touchmove",function(t){if(e.mouseDown){let r=i(t),a=e.parentNode.getBoundingClientRect(),u=e.getBoundingClientRect(),d=s(e),p=s(e.parentNode),c=(r.pageX-e.start[0])/p.m11,l=(r.pageY-e.start[1])/p.m22;function n(t,o){let n="x"==o?e.offsetLeft:e.offsetTop,s="x"==o?e.offsetWidth:e.offsetHeight,i="x"==o?e.parentNode.offsetWidth:e.parentNode.offsetHeight,f="x"==o?"width":"height",r="x"==o?d.m41:d.m42,p="x"==o?d.m11:d.m22,c=getComputedStyle(e).transformOrigin.match(/(\d+)/gm).map(t=>parseInt(t)),l=("x"==o?c[0]:c[1])/s,m=(1-p)*s,g=r+n+m*l,h=i-s-(r+n)+m*(1-l),x=u[o]-a[o]-g,w=u[o]+u[f]-(a[o]+a[f])+h,v=a[o]-u[o]+r,y=a[f]-u[f]+v;return Math.min(Math.max(t,v+x),y+w)}c=e.options.axis.toLowerCase().indexOf("x")>-1?n(c,"x"):d.m41,l=e.options.axis.toLowerCase().indexOf("y")>-1?n(l,"y"):d.m42,e.options.grid&&e.options.grid.dragSnap?o(c,l):f(d,c,l),e.options.drag.call(e,t)}}),e.setGridPosition=function(t,o){if(e.options.grid){let n=e.parentNode.offsetWidth/e.options.grid.columns,s=e.parentNode.offsetHeight/e.options.grid.rows,i=(e.offsetWidth-n)/2,f=(e.offsetHeight-s)/2;x=Math.round(o*n-i),y=Math.round(t*s-f),e.setPosition(x,y)}},e.getPosition=function(){let t=s(this),e={};e.pixels=t.m41+this.offsetLeft,e.percentage=e.pixels/this.parentNode.offsetWidth;let o={};return o.pixels=t.m42+this.offsetTop,o.percentage=o.pixels/this.parentNode.offsetHeight,{left:e,top:o}},e.setPosition=function(t,o){let n=parseFloat(""+t)-e.offsetLeft,i=parseFloat(""+o)-e.offsetTop;f(s(e),n,i)},e.options.init.call(e)},NodeList.prototype.DraggableJS=function(t){this.forEach(e=>e.DraggableJS(t))};